{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\lessons\\\\React\\\\kmb-11\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\lessons\\\\React\\\\kmb-11\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"C:\\\\lessons\\\\React\\\\kmb-11\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"C:\\\\lessons\\\\React\\\\kmb-11\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport React from 'react';\nimport { friendsService } from \"../Dall/friends-service\";\nimport { createSelector } from \"reselect\";\nvar initialStateForFriends = {\n  friendsInfo: [],\n  currentPage: 1,\n  friendsCount: null,\n  returnCount: 4,\n  error: null,\n  searchText: \"\",\n  filter: \"\"\n};\nvar SAVE_FRIENDS_INFO = 'NETWORK/FRIENDS/SAVE_FRIENDS_INFO';\nvar ADD_NEXT_FRIENDS = 'NETWORK/FRIENDS/ADD_NEXT_FRIENDS';\nvar SET_ERROR = 'NETWORK/FRIENDS/SET_ERROR';\nvar CLEAR_AFTER_LEAVE = 'NETWORK/FRIENDS/CLEAR_AFTER_LEAVE';\nvar CHANGE_SEARCH_TEXT = 'NETWORK/FRIENDS/NETWORK/FRIENDS/CLEAR_AFTER_LEAVE';\nvar SET_FILTER = 'NETWORK/FRIENDS/NETWORK/FRIENDS/SET_FILTER';\n\nvar friendsReducer = function friendsReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialStateForFriends;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  var stateCopy = _objectSpread({}, state);\n\n  stateCopy.friendsInfo = _toConsumableArray(state.friendsInfo);\n\n  switch (action.type) {\n    case SAVE_FRIENDS_INFO:\n      action.newFriendsInfo.map(function (el) {\n        stateCopy.friendsInfo.push(el);\n      });\n      return stateCopy;\n\n    case ADD_NEXT_FRIENDS:\n      stateCopy.currentPage = stateCopy.currentPage + 1;\n      return stateCopy;\n\n    case SET_ERROR:\n      stateCopy.error = \"Пользователи закончились\";\n      return stateCopy;\n\n    case CLEAR_AFTER_LEAVE:\n      stateCopy.friendsInfo = [];\n      stateCopy.currentPage = 1;\n      stateCopy.friendsCount = null;\n      stateCopy.error = null;\n      return stateCopy;\n\n    case CHANGE_SEARCH_TEXT:\n      stateCopy.searchText = action.searchText;\n      return stateCopy;\n\n    case SET_FILTER:\n      stateCopy.filter = action.filter;\n      return stateCopy;\n\n    default:\n      return state;\n  }\n};\n\nexport var friendsReturnThunk = function friendsReturnThunk() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(dispatch, getState) {\n        var state, result;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                state = getState();\n                _context.next = 3;\n                return friendsService.getUsers(state.friends.returnCount, state.friends.currentPage);\n\n              case 3:\n                result = _context.sent;\n\n                if (result.totalCount === state.friends.friendsInfo.length) {\n                  dispatch(setErrorCreator());\n                } else {\n                  dispatch(newFriendsInfoCreator(result.items));\n                }\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var addNextFriendsThunk = function addNextFriendsThunk() {\n  return function (dispatch) {\n    dispatch(addNextFriendsCreator());\n    dispatch(friendsReturnThunk());\n  };\n}; //action creaters\n\nexport var setFilterCreator = function setFilterCreator(filter) {\n  return {\n    type: SET_FILTER,\n    filter: filter\n  };\n};\nexport var changeSearchCreator = function changeSearchCreator(searchText) {\n  return {\n    type: CHANGE_SEARCH_TEXT,\n    searchText: searchText\n  };\n};\n\nvar newFriendsInfoCreator = function newFriendsInfoCreator(newFriendsArray) {\n  return {\n    type: SAVE_FRIENDS_INFO,\n    newFriendsInfo: newFriendsArray\n  };\n};\n\nvar addNextFriendsCreator = function addNextFriendsCreator() {\n  return {\n    type: ADD_NEXT_FRIENDS\n  };\n};\n\nvar setErrorCreator = function setErrorCreator() {\n  return {\n    type: SET_ERROR\n  };\n};\n\nexport var clearAfterLeaveCreation = function clearAfterLeaveCreation() {\n  return {\n    type: CLEAR_AFTER_LEAVE\n  };\n}; //Selectors\n\nexport var friendsInfoSelector = function friendsInfoSelector(state) {\n  return state.friends.friendsInfo;\n};\nexport var filterSelector = function filterSelector(state) {\n  return state.friends.filter;\n};\nexport var getFilteredUsersReselector = createSelector(friendsInfoSelector, //первый селектор от которого зависит перериросвка компонента\nfilterSelector, //второй селектор от которого зависит перерисовка компонента\nfunction (users, filterText) {\n  return users.filter(function (el) {\n    return el.name.toUpperCase().indexOf(filterText.toUpperCase()) > -1;\n  });\n}); //третьим параметром передается колбэк функция, где users и filterText это результаты работы\n//селекторов. В этом колбэке возвращается наша фильтровка массива. Это будет выполнятся только\n//когда будут происходит изменения в users и filterText\n\nexport default friendsReducer;","map":{"version":3,"sources":["C:\\lessons\\React\\kmb-11\\src\\Reducers\\friendsReducer.js"],"names":["React","friendsService","createSelector","initialStateForFriends","friendsInfo","currentPage","friendsCount","returnCount","error","searchText","filter","SAVE_FRIENDS_INFO","ADD_NEXT_FRIENDS","SET_ERROR","CLEAR_AFTER_LEAVE","CHANGE_SEARCH_TEXT","SET_FILTER","friendsReducer","state","action","stateCopy","type","newFriendsInfo","map","el","push","friendsReturnThunk","dispatch","getState","getUsers","friends","result","totalCount","length","setErrorCreator","newFriendsInfoCreator","items","addNextFriendsThunk","addNextFriendsCreator","setFilterCreator","changeSearchCreator","newFriendsArray","clearAfterLeaveCreation","friendsInfoSelector","filterSelector","getFilteredUsersReselector","users","filterText","name","toUpperCase","indexOf"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {friendsService} from \"../Dall/friends-service\";\nimport {createSelector} from \"reselect\";\n\nlet initialStateForFriends = {\n    friendsInfo: [],\n    currentPage: 1,\n    friendsCount: null,\n    returnCount: 4,\n    error: null,\n    searchText: \"\",\n    filter: \"\"\n};\n\nconst SAVE_FRIENDS_INFO = 'NETWORK/FRIENDS/SAVE_FRIENDS_INFO';\nconst ADD_NEXT_FRIENDS = 'NETWORK/FRIENDS/ADD_NEXT_FRIENDS';\nconst SET_ERROR = 'NETWORK/FRIENDS/SET_ERROR';\nconst CLEAR_AFTER_LEAVE = 'NETWORK/FRIENDS/CLEAR_AFTER_LEAVE';\nconst CHANGE_SEARCH_TEXT = 'NETWORK/FRIENDS/NETWORK/FRIENDS/CLEAR_AFTER_LEAVE'\nconst SET_FILTER = 'NETWORK/FRIENDS/NETWORK/FRIENDS/SET_FILTER'\n\n\nconst friendsReducer = (state = initialStateForFriends, action) => {\n    let stateCopy = {...state}\n    stateCopy.friendsInfo = [...state.friendsInfo]\n    switch (action.type) {\n        case SAVE_FRIENDS_INFO:\n            action.newFriendsInfo.map(el => {\n                stateCopy.friendsInfo.push(el)\n            })\n            return stateCopy\n        case ADD_NEXT_FRIENDS:\n            stateCopy.currentPage = stateCopy.currentPage + 1\n            return stateCopy\n        case SET_ERROR:\n            stateCopy.error = \"Пользователи закончились\"\n            return stateCopy\n        case CLEAR_AFTER_LEAVE:\n            stateCopy.friendsInfo = []\n            stateCopy.currentPage = 1\n            stateCopy.friendsCount = null\n            stateCopy.error = null\n            return stateCopy\n        case CHANGE_SEARCH_TEXT:\n            stateCopy.searchText = action.searchText\n            return stateCopy\n        case SET_FILTER:\n            stateCopy.filter = action.filter\n            return stateCopy\n        default:\n            return state;\n    }\n};\n\nexport const friendsReturnThunk = () => {\n    return async (dispatch, getState) => {\n        let state = getState();\n        let result = await friendsService.getUsers(state.friends.returnCount, state.friends.currentPage);\n        if (result.totalCount === state.friends.friendsInfo.length) {\n            dispatch(setErrorCreator())\n        } else {\n            dispatch(newFriendsInfoCreator(result.items))\n        }\n    }\n}\n\nexport const addNextFriendsThunk = () => {\n    return (dispatch) => {\n        dispatch(addNextFriendsCreator())\n        dispatch(friendsReturnThunk())\n    }\n}\n\n//action creaters\nexport const setFilterCreator = (filter) => {\n    return {\n        type: SET_FILTER,\n        filter\n    }\n}\n\nexport const changeSearchCreator = (searchText) => {\n    return {\n        type: CHANGE_SEARCH_TEXT,\n        searchText\n    }\n}\n\nconst newFriendsInfoCreator = (newFriendsArray) => {\n    return {\n        type: SAVE_FRIENDS_INFO,\n        newFriendsInfo: newFriendsArray\n    }\n}\n\nconst addNextFriendsCreator = () => {\n    return {\n        type: ADD_NEXT_FRIENDS\n    }\n}\n\nconst setErrorCreator = () => {\n    return {\n        type: SET_ERROR\n    }\n}\n\nexport const clearAfterLeaveCreation = () => {\n    return {\n        type: CLEAR_AFTER_LEAVE\n    }\n}\n\n//Selectors\nexport const friendsInfoSelector = (state) => {\n    return state.friends.friendsInfo\n}\n\nexport const filterSelector = (state) => {\n    return state.friends.filter\n}\n\nexport const getFilteredUsersReselector = createSelector(\n    friendsInfoSelector,//первый селектор от которого зависит перериросвка компонента\n    filterSelector,//второй селектор от которого зависит перерисовка компонента\n    (users, filterText) => {\n        return users.filter(el =>\n            el.name.toUpperCase().indexOf(filterText.toUpperCase()) > -1)\n    })//третьим параметром передается колбэк функция, где users и filterText это результаты работы\n//селекторов. В этом колбэке возвращается наша фильтровка массива. Это будет выполнятся только\n//когда будут происходит изменения в users и filterText\n\nexport default friendsReducer;\n"]},"metadata":{},"sourceType":"module"}