{"ast":null,"code":"import _toConsumableArray from \"C:\\\\lessons\\\\React\\\\kmb-11\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"C:\\\\lessons\\\\React\\\\kmb-11\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport React from 'react';\nimport { friendsService } from \"../Dall/friends-service\";\nvar initialStateForFriends = {\n  friendsInfo: [],\n  currentPage: 1,\n  friendsCount: null,\n  returnCount: 4,\n  error: null\n};\nvar SAVE_FRIENDS_INFO = 'NETWORK/FRIENDS/SAVE_FRIENDS_INFO';\nvar ADD_NEXT_FRIENDS = 'NETWORK/FRIENDS/ADD_NEXT_FRIENDS';\nvar SET_ERROR = 'NETWORK/FRIENDS/SET_ERROR';\nvar CLEAR_AFTER_LEAVE = 'NETWORK/FRIENDS/CLEAR_AFTER_LEAVE';\n\nvar friendsReducer = function friendsReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialStateForFriends;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  var stateCopy = _objectSpread({}, state);\n\n  stateCopy.friendsInfo = _toConsumableArray(state.friendsInfo);\n\n  switch (action.type) {\n    case SAVE_FRIENDS_INFO:\n      action.newFriendsInfo.map(function (el) {\n        stateCopy.friendsInfo.push(el);\n      });\n      return stateCopy;\n\n    case ADD_NEXT_FRIENDS:\n      stateCopy.currentPage = stateCopy.currentPage + 1;\n      return stateCopy;\n\n    case SET_ERROR:\n      stateCopy.error = \"Пользователи закончились\";\n      return stateCopy;\n\n    case CLEAR_AFTER_LEAVE:\n      stateCopy.friendsInfo = [];\n      stateCopy.currentPage = 1;\n      stateCopy.friendsCount = null;\n      stateCopy.error = null;\n      return stateCopy;\n\n    default:\n      return state;\n  }\n};\n\nexport var friendsReturnThunk = function friendsReturnThunk() {\n  return function (dispatch, getState) {\n    var state = getState();\n    friendsService.getUsers(state.friends.returnCount, state.friends.currentPage).then(function (result) {\n      if (result.totalCount === state.friends.friendsInfo.length) {\n        dispatch(setErrorCreator());\n      } else {\n        dispatch(newFriendsInfoCreator(result.items));\n      }\n    });\n  };\n};\nexport var addNextFriendsThunk = function addNextFriendsThunk() {\n  return function (dispatch) {\n    dispatch(addNextFriendsCreator());\n    dispatch(friendsReturnThunk());\n  };\n}; //action creaters\n\nvar newFriendsInfoCreator = function newFriendsInfoCreator(newFriendsArray) {\n  return {\n    type: SAVE_FRIENDS_INFO,\n    newFriendsInfo: newFriendsArray\n  };\n};\n\nvar addNextFriendsCreator = function addNextFriendsCreator() {\n  return {\n    type: ADD_NEXT_FRIENDS\n  };\n};\n\nvar setErrorCreator = function setErrorCreator() {\n  return {\n    type: SET_ERROR\n  };\n};\n\nexport var clearAfterLeaveCreation = function clearAfterLeaveCreation() {\n  return {\n    type: CLEAR_AFTER_LEAVE\n  };\n};\nexport default friendsReducer;","map":{"version":3,"sources":["C:\\lessons\\React\\kmb-11\\src\\Reducers\\friendsReducer.js"],"names":["React","friendsService","initialStateForFriends","friendsInfo","currentPage","friendsCount","returnCount","error","SAVE_FRIENDS_INFO","ADD_NEXT_FRIENDS","SET_ERROR","CLEAR_AFTER_LEAVE","friendsReducer","state","action","stateCopy","type","newFriendsInfo","map","el","push","friendsReturnThunk","dispatch","getState","getUsers","friends","then","result","totalCount","length","setErrorCreator","newFriendsInfoCreator","items","addNextFriendsThunk","addNextFriendsCreator","newFriendsArray","clearAfterLeaveCreation"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {friendsService} from \"../Dall/friends-service\";\n\nlet initialStateForFriends = {\n    friendsInfo: [],\n    currentPage: 1,\n    friendsCount: null,\n    returnCount: 4,\n    error: null\n};\n\nconst SAVE_FRIENDS_INFO = 'NETWORK/FRIENDS/SAVE_FRIENDS_INFO';\nconst ADD_NEXT_FRIENDS = 'NETWORK/FRIENDS/ADD_NEXT_FRIENDS';\nconst SET_ERROR = 'NETWORK/FRIENDS/SET_ERROR';\nconst CLEAR_AFTER_LEAVE = 'NETWORK/FRIENDS/CLEAR_AFTER_LEAVE';\n\nconst friendsReducer = (state = initialStateForFriends, action) => {\n    let stateCopy = {...state}\n    stateCopy.friendsInfo = [...state.friendsInfo]\n    switch (action.type) {\n        case SAVE_FRIENDS_INFO:\n            action.newFriendsInfo.map(el=>{\n                stateCopy.friendsInfo.push(el)\n            })\n            return stateCopy\n        case ADD_NEXT_FRIENDS:\n            stateCopy.currentPage = stateCopy.currentPage+1\n            return stateCopy\n        case SET_ERROR:\n            stateCopy.error = \"Пользователи закончились\"\n            return stateCopy\n        case CLEAR_AFTER_LEAVE:\n            stateCopy.friendsInfo = []\n            stateCopy.currentPage = 1\n            stateCopy.friendsCount = null\n            stateCopy.error = null\n            return stateCopy\n        default:\n            return state;\n    }\n};\n\nexport const friendsReturnThunk = () => {\n    return (dispatch, getState) => {\n        let state = getState();\n        friendsService.getUsers(state.friends.returnCount, state.friends.currentPage).then(\n            result => {\n                if(result.totalCount === state.friends.friendsInfo.length) {\n                    dispatch(setErrorCreator())\n                } else {\n                    dispatch(newFriendsInfoCreator(result.items))\n                }\n            }\n        )\n    }\n}\n\nexport const addNextFriendsThunk = () => {\n    return (dispatch) => {\n        dispatch(addNextFriendsCreator())\n        dispatch(friendsReturnThunk())\n    }\n}\n\n//action creaters\n\nconst newFriendsInfoCreator = (newFriendsArray) => {\n    return {\n        type: SAVE_FRIENDS_INFO,\n        newFriendsInfo: newFriendsArray\n    }\n}\n\nconst addNextFriendsCreator = () => {\n    return {\n        type: ADD_NEXT_FRIENDS\n    }\n}\n\nconst setErrorCreator = () => {\n    return {\n        type: SET_ERROR\n    }\n}\n\nexport const clearAfterLeaveCreation = () => {\n    return {\n        type: CLEAR_AFTER_LEAVE\n    }\n}\n\n\nexport default friendsReducer;\n"]},"metadata":{},"sourceType":"module"}